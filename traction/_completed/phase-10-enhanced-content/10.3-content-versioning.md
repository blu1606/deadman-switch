# 10.3 Content Versioning

> Cho phép thêm/sửa nội dung vault sau khi tạo, với lịch sử version.

## Goal
User đã tạo vault nhưng muốn:
- Thêm file mới
- Sửa text message
- Xóa item cũ

Và giữ được lịch sử các version trước.

## Approach
**Versioned Bundle** - Mỗi lần update tạo bundle mới có link đến version cũ.

```
Bundle v3 → previousCid → Bundle v2 → previousCid → Bundle v1
```

## Bundle Schema Update
```
{
  version: 3,
  previousCid: "Qm...", // Link to previous version
  items: [...],
  changelog: "Added voice message"
}
```

## Contract Changes
Thêm instruction `update_content(new_cid, new_encrypted_key)`:
- Chỉ owner gọi được
- Không update được nếu đã release
- Cập nhật `ipfs_cid` và `encrypted_key`

## Flow
1. User mở "Edit Contents"
2. Fetch & decrypt current bundle
3. Add/remove/edit items
4. Re-encrypt new bundle (với previousCid)
5. Upload to IPFS → new CID
6. Call `update_content` on-chain
7. Sign transaction

## History View
- "View History" button trong vault details
- Liệt kê các version với changelog
- Download any version
